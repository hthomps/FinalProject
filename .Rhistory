install.packages("seqinr")
load("MeltedData.RData")
View(dat2)
# load in transcriptome data
dat <- read.csv("MothData.csv")
# load packages
library(tidyverse)
library(reshape2)
# we need to melt the dataset to each row a unique gene - transcriptome combination
# we'll use the melt function in the reshape2 package
dat2 <- dat %>% melt(id.vars = c("gene_id", "gene_description"),
measure.vars = c("H.L2.D1", "H.L3.D1", "H.L4.12h", "H.L4.Late",
"H.L5.12hS", "H.L5.D2S", "H.L5.preWS", "H.P.Late",
"H.A.D1", "H.A.D3", "H.A.D7", "F.L4.Late", "F.L5.D1",
"F.L5.preW", "F.L5.W", "F.P.D13S", "F.P.D1518", "F.A.D13",
"F.A.D79", "W.E.3hS", "W.E.LateS", "W.L1.D1S", "W.L2.D1S",
"W.L3.D1S", "G.L2.unk", "G.L3.LateS", "G.L4.0h", "G.L4.12hS", "G.L4.LateS",
"G.L5.13hS", "G.L5.D1S", "G.L5.preWS", "G.L5.WS", "G.L5.W",
"G.P.D1", "G.P.D1518", "G.A.D35", "MT.L5.preW", "MT.A.D1",
"MT.A.D3", "M.L4.Late", "M.L5.12h", "M.L5.12hS", "M.L5.preW",
"M.L5.preWS","M.L5.W", "M.L5.WS",  "T.P.D3",  "T.P.D1518",
"T.A.D13", "O.P.D1518", "O.A.D1", "H.A.D1F1S", "H.A.D1F2S",
"H.A.D1F3S", "H.A.D1F4S", "H.A.D1M1S", "H.A.D1M2S", "H.A.D1M3S",
"H.A.D1M4S", "An.L5.1S", "An.L5.2S", "An.L5.3S", "An.A.F1S", "An.A.F2S",  "An.A.F3S", "An.A.MS"))
colnames(dat2)[4] <- "copynumber"
# let's rename the "variable" and "value" columns to something more informative
colnames(dat2)[3] <- "transcriptome"
# let's pull apart the transcriptome names into the tissue type (which is the code before
# the first . ), life stage (the code between .'s), and whatever is on the end
# we use the separate command in dplyr
dat2 <- dat2 %>% separate(transcriptome, into = c("tissue", "life_stage", "note"),
remove = FALSE, extra = "drop")
# let's just grab the data for the life stages (adult and 5th instar larva)
# and tissue types (fatbody, head, and midgut) that we want
subdat <- dat2 %>% filter(life_stage == "L5" | life_stage == "A") %>% filter(tissue == "H" | tissue == "G" | tissue == "F")
# change them to factors for easier graphing later on
subdat$life_stage <- as.factor(subdat$life_stage)
subdat$tissue <- as.factor(subdat$tissue)
# now lets make separate dataesets for each tissue type, and get the mean expression
# level for each lifestage
headdat <- subdat %>% filter(tissue == "H") %>% group_by(gene_id, life_stage) %>% summarise(mean = round(mean(copynumber), digits = 3))
# now we cast it back out so there is a column for adult (A) and a column for larva (L5)
# and then take the difference between those two columns
headdat2 <- headdat %>% dcast(gene_id ~ life_stage, mean) %>% mutate(diff = abs(A - L5))
gutdat <- subdat %>% filter(tissue == "G") %>% group_by(gene_id, life_stage) %>% summarise(mean = round(mean(copynumber), digits = 3))
fatdat2 <- fatdat %>% dcast(gene_id ~ life_stage, mean) %>% mutate(diff = abs(A - L5))
fatdat <- subdat %>% filter(tissue == "F") %>% group_by(gene_id, life_stage) %>% summarise(mean = round(mean(copynumber), digits = 3))
# the fatbody genes with the greatest difference between adult and L5 are:
# the fatbody genes with the greatest difference between adult and L5 are:
# Msex2.15420, Msex2.01694, Msex2.10735
gutdat2 <- gutdat %>% dcast(gene_id ~ life_stage, mean) %>% mutate(diff = abs(A - L5))
# the fatbody genes with the greatest difference between adult and L5 are:
# Msex2.15420, Msex2.01694, Msex2.10735
# the fatbody genes with the greatest difference between adult and L5 are:
# Msex2.15420, Msex2.01694, Msex2.10735
# the fatbody genes with the greatest difference between adult and L5 are:
# Msex2.15420, Msex2.01694, Msex2.10735
# the fatbody genes with the greatest difference between adult and L5 are:
# Msex2.15420, Msex2.01694, Msex2.10735
# the fatbody genes with the greatest difference between adult and L5 are:
# Msex2.15420, Msex2.01694, Msex2.10735
dat
# load in transcriptome data
dat <- read.csv("MothData.csv")
dat
colnames(dat[,1])<-"gene_id"
colnames(dat[i])<-"gene_id"
colnames(dat[1])<-"gene_id"
# we need to melt the dataset to each row a unique gene - transcriptome combination
# we'll use the melt function in the reshape2 package
dat2 <- dat %>% melt(id.vars = c("gene_id", "gene_description"),
measure.vars = c("H.L2.D1", "H.L3.D1", "H.L4.12h", "H.L4.Late",
"H.L5.12hS", "H.L5.D2S", "H.L5.preWS", "H.P.Late",
"H.A.D1", "H.A.D3", "H.A.D7", "F.L4.Late", "F.L5.D1",
"F.L5.preW", "F.L5.W", "F.P.D13S", "F.P.D1518", "F.A.D13",
"F.A.D79", "W.E.3hS", "W.E.LateS", "W.L1.D1S", "W.L2.D1S",
"W.L3.D1S", "G.L2.unk", "G.L3.LateS", "G.L4.0h", "G.L4.12hS", "G.L4.LateS",
"G.L5.13hS", "G.L5.D1S", "G.L5.preWS", "G.L5.WS", "G.L5.W",
"G.P.D1", "G.P.D1518", "G.A.D35", "MT.L5.preW", "MT.A.D1",
"MT.A.D3", "M.L4.Late", "M.L5.12h", "M.L5.12hS", "M.L5.preW",
"M.L5.preWS","M.L5.W", "M.L5.WS",  "T.P.D3",  "T.P.D1518",
"T.A.D13", "O.P.D1518", "O.A.D1", "H.A.D1F1S", "H.A.D1F2S",
"H.A.D1F3S", "H.A.D1F4S", "H.A.D1M1S", "H.A.D1M2S", "H.A.D1M3S",
"H.A.D1M4S", "An.L5.1S", "An.L5.2S", "An.L5.3S", "An.A.F1S", "An.A.F2S",  "An.A.F3S", "An.A.MS"))
dat
colnames(dat)
colnames(dat[1])<-"gene_id"
colnames(dat[1])
# load in transcriptome data
dat <- read.csv("MothData.csv", header=T)
dat
load("MeltedData.RData")
# load in transcriptome data
dat <- read.csv("MothData.csv")
colnames(dat)[1]<-"gene_id"
colnames(dat)
# we need to melt the dataset to each row a unique gene - transcriptome combination
# we'll use the melt function in the reshape2 package
dat2 <- dat %>% melt(id.vars = c("gene_id", "gene_description"),
measure.vars = c("H.L2.D1", "H.L3.D1", "H.L4.12h", "H.L4.Late",
"H.L5.12hS", "H.L5.D2S", "H.L5.preWS", "H.P.Late",
"H.A.D1", "H.A.D3", "H.A.D7", "F.L4.Late", "F.L5.D1",
"F.L5.preW", "F.L5.W", "F.P.D13S", "F.P.D1518", "F.A.D13",
"F.A.D79", "W.E.3hS", "W.E.LateS", "W.L1.D1S", "W.L2.D1S",
"W.L3.D1S", "G.L2.unk", "G.L3.LateS", "G.L4.0h", "G.L4.12hS", "G.L4.LateS",
"G.L5.13hS", "G.L5.D1S", "G.L5.preWS", "G.L5.WS", "G.L5.W",
"G.P.D1", "G.P.D1518", "G.A.D35", "MT.L5.preW", "MT.A.D1",
"MT.A.D3", "M.L4.Late", "M.L5.12h", "M.L5.12hS", "M.L5.preW",
"M.L5.preWS","M.L5.W", "M.L5.WS",  "T.P.D3",  "T.P.D1518",
"T.A.D13", "O.P.D1518", "O.A.D1", "H.A.D1F1S", "H.A.D1F2S",
"H.A.D1F3S", "H.A.D1F4S", "H.A.D1M1S", "H.A.D1M2S", "H.A.D1M3S",
"H.A.D1M4S", "An.L5.1S", "An.L5.2S", "An.L5.3S", "An.A.F1S", "An.A.F2S",  "An.A.F3S", "An.A.MS"))
# let's rename the "variable" and "value" columns to something more informative
colnames(dat2)[3] <- "transcriptome"
colnames(dat2)[4] <- "copynumber"
# let's pull apart the transcriptome names into the tissue type (which is the code before
# the first . ), life stage (the code between .'s), and whatever is on the end
# we use the separate command in dplyr
dat2 <- dat2 %>% separate(transcriptome, into = c("tissue", "life_stage", "note"),
remove = FALSE, extra = "drop")
# let's just grab the data for the life stages (adult and 5th instar larva)
# and tissue types (fatbody, head, and midgut) that we want
subdat <- dat2 %>% filter(life_stage == "L5" | life_stage == "A") %>% filter(tissue == "H" | tissue == "G" | tissue == "F")
# change them to factors for easier graphing later on
subdat$life_stage <- as.factor(subdat$life_stage)
subdat$tissue <- as.factor(subdat$tissue)
# now lets make separate dataesets for each tissue type, and get the mean expression
# level for each lifestage
headdat <- subdat %>% filter(tissue == "H") %>% group_by(gene_id, life_stage) %>% summarise(mean = round(mean(copynumber), digits = 3))
gutdat <- subdat %>% filter(tissue == "G") %>% group_by(gene_id, life_stage) %>% summarise(mean = round(mean(copynumber), digits = 3))
fatdat <- subdat %>% filter(tissue == "F") %>% group_by(gene_id, life_stage) %>% summarise(mean = round(mean(copynumber), digits = 3))
# now we cast it back out so there is a column for adult (A) and a column for larva (L5)
# and then take the difference between those two columns
headdat2 <- headdat %>% dcast(gene_id ~ life_stage, mean) %>% mutate(diff = abs(A - L5))
gutdat2 <- gutdat %>% dcast(gene_id ~ life_stage, mean) %>% mutate(diff = abs(A - L5))
fatdat2 <- fatdat %>% dcast(gene_id ~ life_stage, mean) %>% mutate(diff = abs(A - L5))
# the fatbody genes with the greatest difference between adult and L5 are:
# the fatbody genes with the greatest difference between adult and L5 are:
# Msex2.15420, Msex2.01694, Msex2.10735
# the fatbody genes with the greatest difference between adult and L5 are:
# Msex2.15420, Msex2.01694, Msex2.10735
# now we cast it back out so there is a column for adult (A) and a column for larva (L5)
# and then take the difference between those two columns
headdat2 <- headdat %>% dcast(gene_id ~ life_stage, mean) %>% mutate(diff = abs(A - L5))
headdat2
# now we cast it back out so there is a column for adult (A) and a column for larva (L5)
# and then take the difference between those two columns
headdat2 <- headdat %>% dcast(gene_id ~ life_stage, mean) %>% mutate(diff = abs(A - L5)) %>% arrange(desc(diff))
headdat2
save.image("~/GitHub/FinalProject/MeltedData.RData")
load("MeltedData.RData")
library(dplyr)
library(tidyverse)
library(seqinr)
msex.prot <- system.file("ms_ogs_proteins.fa", package = "seqinr")
read.fasta(msex.prot, seqtype = "AA", as.string = TRUE, set.attributes = FALSE)
msex.prot <- system.file("ms_ogs_proteins.fasta", package = "seqinr")
read.fasta(msex.prot, seqtype = "AA", as.string = TRUE, set.attributes = FALSE)
cat(readLines(msex.prot), sep="\n")
cwd()
wd{}
wd()
getwd()
cat(readLines(msex.prot))
msex.prot <- system.file("ms_ogs_proteins.fasta")
read.fasta(msex.prot, seqtype = "AA", as.string = TRUE, set.attributes = FALSE)
read.fasta("ms_ogs_proteins.fasta", seqtype = "AA", as.string = TRUE, set.attributes = FALSE)
msex.prot<-read.fasta("ms_ogs_proteins.fasta", seqtype = "AA", as.string = TRUE, set.attributes = FALSE)
names(msex.prot)
str(msex.prot)
save(msex.prot, file="msex_prot.RData")
library(dplyr)
library(tidyverse)
load("MeltedData.RData")
library(seqinr)
#Load Rdata
load("msex_prot.RData")
str(msex.prot)
msex.prot[1]
names(msex.prot[1])
d.msex.prot<-data.frame(protein=names(msex.prot), seq=msex.prot)
head.msex.prot
head(msex.prot)
head(d.msex.prot)
str(d.msex.prot)
is.vector(msex.prot)
protein=names(msex.prot)
head(protein)
head(msex.prot)
msex.prot[1]
unname(msex.prot)
msex.prot<-unname(msex.prot)
msex.prot[1]
d.msex.prot<-data.frame(protein=protein, seq=as.character(msex.prot))
head(d.msex.prot)
str(d.msex.prot)
#Load Rdata
load("msex_prot.RData")
length(msex.prot)
msex.prot<-unname(msex.prot)
length(msex.prot)
d.msex.prot<-data.frame(protein=protein, seq=msex.prot)
str(d.msex.prot)
#Load Rdata
load("msex_prot.RData")
is.list(msex.prot)
msex.prot<-unlist(msex.prot)
str(msex.prot)
head(msex.prot)
#Load Rdata
load("msex_prot.RData")
protein=names(msex.prot)
msex.prot<-unname(msex.prot)
length(msex.prot)
length(protein)
msex.prot<-unlist(msex.prot)
msex.prot[1]
rm(msex.prot)
#Load Rdata
load("msex_prot.RData") #named list
protein=names(msex.prot) #extract protein ID from list
msex.prot<-unname(msex.prot) #unname list
length(msex.prot)
length(protein)
seq<-unlist(msex.prot);rm(msex.prot)
msex.prot<-data.frame(protein, seq)
str(msex.prot)
msex.prot<-data.frame(protein, seq<-as.character(seq))
str(msex.prot)
msex.prot<-data.frame(protein, seq)
msex.prot$seq<-as.character(msex.prot$seq)
str(msex.prot)
#save file as RData to load file faster in the future
save(msex.prot, file="msex_prot.RData")
#Load data
load("msex_prot.RData")
